From b63981a9fe005a1fccb105cdecc368b9e6668269 Mon Sep 17 00:00:00 2001
From: Lin Cheng <lin_cheng@dell.com>
Date: Sat, 28 Jan 2023 17:53:05 +0800
Subject: [PATCH] fix: alwaysOnTop not being respected when NativeWindow hidden
      Thin OS UI has alwaysOnTop flag when window not mapped in X client

---
 ui/ozone/platform/x11/x11_window.cc | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/ui/ozone/platform/x11/x11_window.cc b/ui/ozone/platform/x11/x11_window.cc
index 45e0a75a643c2..d696eea7743e0 100644
--- a/ui/ozone/platform/x11/x11_window.cc
+++ b/ui/ozone/platform/x11/x11_window.cc
@@ -2365,13 +2365,12 @@ void X11Window::OnWMStateUpdated() {

 void X11Window::UpdateWindowProperties(
     const base::flat_set<x11::Atom>& new_window_properties) {
+  window_properties_ = new_window_properties;
   // If the window is hidden, ignore new properties.
   // See https://crbug.com/1260832
   if (!window_mapped_in_client_)
     return;

-  window_properties_ = new_window_properties;
-
   // Ignore requests by the window manager to enter or exit fullscreen (e.g. as
   // a result of pressing a window manager accelerator key). Chrome does not
   // handle window manager initiated fullscreen. In particular, Chrome needs to
--
2.25.1

