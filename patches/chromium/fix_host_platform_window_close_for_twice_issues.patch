From 0bd5760587e0f9c868aaff0554c162f875770dda Mon Sep 17 00:00:00 2001
From: Lin Cheng <lin_cheng@dell.com>
Date: Tue, 22 Feb 2022 04:47:52 -0500
Subject: [PATCH] fix host platform window close for twice issues

webContents on Thin OS machines it may happen that the window gets destroyed for twice,
checking platform_window() can effectively guard against that.
---
 .../widget/desktop_aura/desktop_window_tree_host_platform.cc   | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/ui/views/widget/desktop_aura/desktop_window_tree_host_platform.cc b/ui/views/widget/desktop_aura/desktop_window_tree_host_platform.cc
index 5750a270fc4f4..55e0051651a05 100644
--- a/ui/views/widget/desktop_aura/desktop_window_tree_host_platform.cc
+++ b/ui/views/widget/desktop_aura/desktop_window_tree_host_platform.cc
@@ -334,7 +334,8 @@ void DesktopWindowTreeHostPlatform::CloseNow() {
   // example.
   DestroyCompositor();
 
-  platform_window()->Close();
+  if (platform_window())
+    platform_window()->Close();
 }
 
 aura::WindowTreeHost* DesktopWindowTreeHostPlatform::AsWindowTreeHost() {
-- 
2.17.1

